(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[54],{4630:function(e,t,s){Promise.resolve().then(s.bind(s,2233))},2233:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var r=s(7437),a=s(2265),i=s(3861);function o(){let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)(!0),[l,n]=(0,a.useState)("");(0,a.useEffect)(()=>{c()},[]);let c=async()=>{try{let e=await fetch("/api/photos"),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to fetch photos");t(s.data||[])}catch(e){n(e.message)}finally{o(!1)}},d=async e=>{try{let s=localStorage.getItem("token");if(!s)throw Error("You must be logged in to vote");let r=await fetch("/api/photos/".concat(e,"/vote"),{method:"POST",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}}),a=await r.json();if(!r.ok)throw Error(a.error||"Failed to vote");return t(t=>t.map(t=>t.id===e?{...t,votes:t.votes+1}:t)),Promise.resolve()}catch(e){return n(e.message),Promise.reject(e)}};return(0,r.jsxs)("div",{className:"py-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Discover Photos"}),l&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md",children:l}),s?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):0===e.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("p",{className:"text-xl text-gray-500",children:"No photos found"}),(0,r.jsx)("p",{className:"mt-2",children:"Be the first to upload a photo!"})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,r.jsx)(i.Z,{id:e.id,title:e.title,description:e.description,image_url:e.image_url,votes:e.votes,author:e.author,onVote:d},e.id))})]})}},3861:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(7437),a=s(3145),i=s(2265),o=s(7648);function l(e){let{id:t,title:s,description:l,image_url:n,votes:c,author:d,onVote:h}=e,[m,u]=(0,i.useState)(!1),[x,p]=(0,i.useState)(c),f=async()=>{if(h&&!m){u(!0);try{await h(t),p(e=>e+1)}catch(e){console.error("Error voting:",e)}finally{u(!1)}}};return(0,r.jsxs)("div",{className:"card overflow-hidden",children:[(0,r.jsx)("div",{className:"relative aspect-video w-full mb-3",children:(0,r.jsx)(a.default,{src:n,alt:s,className:"object-cover rounded-md",fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",priority:!0})}),(0,r.jsx)("h3",{className:"text-xl font-semibold mb-1",children:s}),l&&(0,r.jsx)("p",{className:"text-gray-600 mb-3 line-clamp-2",children:l}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["By ",d]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("button",{onClick:f,disabled:m||!h,className:"flex items-center gap-1 text-gray-600 hover:text-primary transition-colors disabled:opacity-50",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),(0,r.jsx)("span",{children:x})]}),(0,r.jsx)(o.default,{href:"/photos/".concat(t),className:"text-primary hover:underline",children:"View"})]})]})]})}}},function(e){e.O(0,[648,145,971,117,744],function(){return e(e.s=4630)}),_N_E=e.O()}]);