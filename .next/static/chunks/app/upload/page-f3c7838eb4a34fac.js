(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{9366:function(e,t,a){Promise.resolve().then(a.bind(a,6657))},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},5523:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return r}});let r=a(7043)._(a(2265)).default.createContext(null)},6657:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var r=a(7437),s=a(2265),l=a(9376),n=a(3145);function i(){let[e,t]=(0,s.useState)(""),[a,i]=(0,s.useState)(""),[o,c]=(0,s.useState)(""),[u,d]=(0,s.useState)(""),[m,h]=(0,s.useState)(""),[p,x]=(0,s.useState)(!1),[f,b]=(0,s.useState)(!1),g=(0,l.useRouter)();(0,s.useEffect)(()=>{if(!localStorage.getItem("token")){g.push("/login");return}b(!0)},[g]);let j=async t=>{if(t.preventDefault(),h(""),!e||!o){h("Title and image URL are required");return}x(!0);try{let t=localStorage.getItem("token"),r=await fetch("/api/photos",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({title:e,description:a||null,image_url:o})}),s=await r.json();if(!r.ok)throw Error(s.error||"Failed to upload photo");g.push("/photos/".concat(s.data.id))}catch(e){h(e.message),x(!1)}},v=e=>{c(e),d(e)};return f?(0,r.jsxs)("div",{className:"py-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Upload a Photo"}),m&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md",children:m}),(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Title *"}),(0,r.jsx)("input",{type:"text",id:"title",value:e,onChange:e=>t(e.target.value),className:"form-input mt-1",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{id:"description",value:a,onChange:e=>i(e.target.value),className:"form-input mt-1",rows:3})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"imageUrl",className:"block text-sm font-medium text-gray-700",children:"Image URL *"}),(0,r.jsx)("input",{type:"url",id:"imageUrl",value:o,onChange:e=>v(e.target.value),className:"form-input mt-1",placeholder:"https://example.com/image.jpg",required:!0}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Enter the URL of your image. Ensure the URL is publicly accessible."})]}),u&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preview"}),(0,r.jsx)("div",{className:"relative aspect-video w-full mb-3 bg-gray-100 rounded-md overflow-hidden",children:(0,r.jsx)(n.default,{src:u,alt:"Preview",fill:!0,className:"object-contain",onError:()=>d("")})})]}),(0,r.jsxs)("div",{className:"flex justify-end",children:[(0,r.jsx)("button",{type:"button",onClick:()=>g.push("/photos"),className:"btn-secondary mr-4",disabled:p,children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",disabled:p||!e||!o,children:p?"Uploading...":"Upload Photo"})]})]})})]}):null}}},function(e){e.O(0,[145,971,117,744],function(){return e(e.s=9366)}),_N_E=e.O()}]);